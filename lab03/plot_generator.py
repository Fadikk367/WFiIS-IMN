import numpy as np
from matplotlib import pyplot as plt

# Load received results
t_1_01, dt_1_01, x_1_01, v_1_01 = np.loadtxt(f'./data/rk2-tol-01.tsv', unpack=True, delimiter='\t')
t_1_00001, dt_1_00001, x_1_00001, v_1_00001 = np.loadtxt(f'./data/rk2-tol-00001.tsv', unpack=True, delimiter='\t')
t_2_01, dt_2_01, x_2_01, v_2_01 = np.loadtxt(f'./data/trapezoidal-tol-01.tsv', unpack=True, delimiter='\t')
t_2_00001, dt_2_00001, x_2_00001, v_2_00001 = np.loadtxt(f'./data/trapezoidal-tol-00001.tsv', unpack=True, delimiter='\t')

# v(t)
plt.plot(t_1_01, v_1_01, label='tol=10^-2')
plt.plot(t_1_00001, v_1_00001, label='tol=10^-5')
plt.title('v(t) - rk2')
plt.ylabel('v')
plt.xlabel('t')
plt.grid(ls=':')
plt.legend()
plt.savefig(f'v(t)_rk2.png')
plt.clf()

# x(t)
plt.plot(t_1_01, x_1_01, label='tol=10^-2')
plt.plot(t_1_00001, x_1_00001, label='tol=10^-5')
plt.title('x(t) - rk2')
plt.ylabel('x')
plt.xlabel('t')
plt.grid(ls=':')
plt.legend()
plt.savefig(f'x(t)_rk2.png')
plt.clf()

# dt(t)
plt.plot(t_1_01, dt_1_01, label='tol=10^-2')
plt.plot(t_1_00001, dt_1_00001, label='tol=10^-5')
plt.title('dt(t) - rk2')
plt.ylabel('dt')
plt.xlabel('t')
plt.grid(ls=':')
plt.legend()
plt.savefig(f'dt(t)_rk2.png')
plt.clf()

# v(x)
plt.plot(x_1_01, v_1_01, label='tol=10^-2')
plt.plot(x_1_00001, v_1_00001, label='tol=10^-5')
plt.title('v(x) - rk2')
plt.ylabel('v')
plt.xlabel('t')
plt.grid(ls=':')
plt.legend()
plt.savefig(f'v(x)_rk2.png')
plt.clf()





# v(t)
plt.plot(t_2_01, v_2_01, label='tol=10^-2')
plt.plot(t_2_00001, v_2_00001, label='tol=10^-5')
plt.title('v(t) - trapez')
plt.ylabel('v')
plt.xlabel('t')
plt.grid(ls=':')
plt.legend()
plt.savefig(f'v(t)_trap.png')
plt.clf()

# x(t)
plt.plot(t_2_01, x_2_01, label='tol=10^-2')
plt.plot(t_2_00001, x_2_00001, label='tol=10^-5')
plt.title('x(t) - trapez')
plt.ylabel('x')
plt.xlabel('t')
plt.grid(ls=':')
plt.legend()
plt.savefig(f'x(t)_trap.png')
plt.clf()

# dt(t)
plt.plot(t_2_01, dt_2_01, label='tol=10^-2')
plt.plot(t_2_00001, dt_2_00001, label='tol=10^-5')
plt.title('dt(t) - trapez')
plt.ylabel('dt')
plt.xlabel('t')
plt.grid(ls=':')
plt.legend()
plt.savefig(f'dt(t)_trap.png')
plt.clf()

# v(x)
plt.plot(x_2_01, v_2_01, label='tol=10^-2')
plt.plot(x_2_00001, v_2_00001, label='tol=10^-5')
plt.title('v(x) - trapez')
plt.ylabel('v')
plt.xlabel('t')
plt.grid(ls=':')
plt.legend()
plt.savefig(f'v(x)_trap.png')
plt.clf()